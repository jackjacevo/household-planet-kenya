# Fail2Ban Configuration for Household Planet Kenya
# Place in /etc/fail2ban/jail.local

[DEFAULT]
# Ban IP for 1 hour after 5 failures within 10 minutes
bantime = 3600
findtime = 600
maxretry = 5

# Email notifications
destemail = admin@householdplanet.co.ke
sendername = Fail2Ban-HouseholdPlanet
mta = sendmail
action = %(action_mwl)s

[sshd]
enabled = true
port = 2222
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 7200

[nginx-http-auth]
enabled = true
filter = nginx-http-auth
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 3

[nginx-limit-req]
enabled = true
filter = nginx-limit-req
port = http,https
logpath = /var/log/nginx/error.log
maxretry = 5
bantime = 1800

[nginx-botsearch]
enabled = true
filter = nginx-botsearch
port = http,https
logpath = /var/log/nginx/access.log
maxretry = 2
bantime = 86400

# Custom filter for Node.js application
[nodejs-auth]
enabled = true
filter = nodejs-auth
port = 3000,3001
logpath = /var/log/household-planet/auth.log
maxretry = 5
bantime = 3600

# Custom filter for API abuse
[api-abuse]
enabled = true
filter = api-abuse
port = 3000
logpath = /var/log/household-planet/api.log
maxretry = 10
findtime = 300
bantime = 1800